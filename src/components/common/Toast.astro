---
// src/components/common/Toast.astro
---

<section
    id='toast-container'
    class='fixed bottom-5 right-5 z-50 flex flex-col gap-2 pointer-events-none'
>
</section>

<script>
    interface ToastEventDetail {
        message: string;
        type?: 'success' | 'error';
    }

    // トーストを表示する関数
    function showToast(message: string, type: 'success' | 'error' = 'success') {
        const container = document.getElementById('toast-container');
        if (!container) return;

        const toast = document.createElement('div');

        const baseClass =
            'pointer-events-auto min-w-[200px] max-w-xs px-4 py-3 rounded shadow-lg text-xs font-medium text-white transform transition-all duration-300 translate-y-0 opacity-100 flex items-center gap-2';
        const colorClass = type === 'success' ? 'bg-slate-800' : 'bg-red-600';

        toast.className = `${baseClass} ${colorClass}`;

        // アイコンとメッセージ
        const icon = type === 'success' ? '✓' : '!';
        toast.innerHTML = `<output><span>${icon}</span> <span>${message}</span></output>`;

        container.appendChild(toast);

        // 3秒後に消す処理
        setTimeout(() => {
            toast.classList.remove('opacity-100', 'translate-y-0');
            toast.classList.add('opacity-0', 'translate-y-2');

            setTimeout(() => {
                toast.remove();
            }, 300);
        }, 3000);
    }

    window.addEventListener('toast', ((
        event: CustomEvent<ToastEventDetail>
    ) => {
        showToast(event.detail.message, event.detail.type);
    }) as EventListener);
</script>
